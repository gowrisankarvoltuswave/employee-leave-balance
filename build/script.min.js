"use strict";app.controller("loginCtrl",function(e,t,o,n,r){e.login=function(e){o.create(e,function(e){e.success?(window.sessionStorage.setItem("token",e.token),t.go("vehicles")):alert("error")})},e.socialAuthbtn=function(){n.fblogin().then(function(e){console.log(e)})},e.googleAuthbtn=function(){r.googleloginmethod().then(function(e){console.log(e)})}}),app.controller("propertyCtrl",function(e,t){t.get(function(t){e.data=t.data})}),app.controller("vehicleCtrl",function(e,t){t.get(function(t){e.vehicleList=t.data})}),angular.module("authApp").service("googleAuthSvc",function(e,t,o){this.googleloginmethod=function(){var n=t.defer();return e({method:"GET",url:o.url+"googlepassport",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){n.resolve(e.data),console.log(e)}).catch(function(e){n.reject(e)}),n.promise}}),angular.module("authApp").service("APIInterceptor",function(e){this.request=function(){e.defaults.headers.post["x-access-token"]=window.sessionStorage.getItem("token")}}),angular.module("authApp").factory("loginSvc",["$resource","Config",function(e,t){return e(t.url+"users",{username:"@username"},{update:{method:"PUT"},delete:{method:"DELETE"},create:{method:"POST"},get:{method:"GET",isArray:!1,headers:{Authorization:"dfgasdfjhkjhk3452i34hpiuhasd9f435kjkad"}}})}]),angular.module("authApp").factory("propertiesSvc",["$resource",function(e){return e("https://oauth.voltuswave.com/properties",{id:"@id"},{update:{method:"PUT"},delete:{method:"DELETE"},create:{method:"POST"},get:{method:"GET",isArray:!1}})}]),angular.module("authApp").service("socialAuth",function(e,t,o){this.fblogin=function(){var n=t.defer();return e({method:"GET",url:o.url+"sociallogin",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){n.resolve(e),console.log(e)}).catch(function(e){n.reject(e)}),n.promise}}),angular.module("authApp").factory("usersSvc",["$resource","Config",function(e,t){return e(t.url+"users/:id",{id:"@id"},{update:{method:"PUT"},delete:{method:"DELETE"},create:{method:"POST"},get:{method:"GET",isArray:!1}})}]),angular.module("authApp").factory("vehiclesSvc",["$resource",function(e){return e("https://oauth.voltuswave.com/vehicles",{id:"@id"},{update:{method:"PUT"},delete:{method:"DELETE"},create:{method:"POST"},get:{method:"GET",isArray:!1}})}]),app.factory("Auth",function(e,t,o,n,r){var u={init:function(){u.isLoggedIn()&&(t.users=u.currentUser())},checkPermissionForView:function(e){return!e.requiresAuthentication||s(e)}},s=function(e){return!!u.isLoggedIn()&&(!e.permissions||!e.permissions.length||u.userHasPermission(e.permissions))};return u.userHasPermission=function(e){if(!u.isLoggedIn())return!1;var t=!1;return angular.forEach(e,function(e,o){angular.fromJson(window.localStorage.getItem("user")).permissions.indexOf(e)>=0&&(t=!0)}),t},u.currentUser=function(){return o.sessionStorage.user},u.isLoggedIn=function(){return null!=angular.fromJson(window.localStorage.getItem("user"))},u}),app.factory("authInterceptor",function(e,t,o,n){return{request:function(e){if(e.headers=e.headers||{},window.sessionStorage.getItem("token")){var t=window.sessionStorage.getItem("token");e.headers["x-access-token"]=t}return e},response:function(e){return e.data.status,e||t.when(e)}}}),app.config(function(e){e.interceptors.push("authInterceptor")});